-- USERS
CREATE TABLE users (
  id SERIAL PRIMARY KEY,
  fullName NVARCHAR(255) NOT NULL,
  phone VARCHAR(11) UNIQUE NOT NULL,
  email VARCHAR(50) UNIQUE NOT NULL,
  password VARCHAR(255) NOT NULL,
  tokenUser VARCHAR(255) UNIQUE NOT NULL,
  role VARCHAR(25) CHECK (role IN ('student', 'parent')) NOT NULL,
  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- PARENT_STUDENT
CREATE TABLE parent_student (
  parent_id INTEGER REFERENCES users(id),
  student_id INTEGER REFERENCES users(id),
  PRIMARY KEY (parent_id, student_id),
  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);

-- forgot_password
CREATE TABLE forgotPassword (
  id SERIAL PRIMARY KEY,
  email VARCHAR(50) NOT NULL,
  otp VARCHAR(10) NOT NULL,
  expireAt TIMESTAMP NOT NULL
);

-- wallets
CREATE TABLE wallets (
  id SERIAL PRIMARY KEY,
  student_id INTEGER UNIQUE REFERENCES users(id),
  balance INTEGER DEFAULT 0,
  createdAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP,
  updatedAt TIMESTAMP NOT NULL DEFAULT CURRENT_TIMESTAMP
);